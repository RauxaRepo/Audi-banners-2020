var manifest = [
        {
            "name": "versionName_txt",
            "type": "text",
            "default": "2020_Audi_T2_ACR_ROT_Intent_Chicago_2020_Multi-Model_Generic"
        },
        {
            "name": "URL_type_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "carMake_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "carMakeTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "carModel_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "carModelTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "F1_headline_txt",
            "type": "text",
            "default": "A season for the senses."
        },
        {
            "name": "F1_headlineTxt_size_hex_xy",
            "type": "text",
            "default": "17.5|#FFF|15,427"
        },
        {
            "name": "F2_headline_txt",
            "type": "text",
            "default": "Unwrap new<br>adventures."
        },
        {
            "name": "F2_headlineTxt_size_hex_xy",
            "type": "text",
            "default": "17.5|#FFF|80,120"
        },
        {
            "name": "F3_headline_txt",
            "type": "text",
            "default": "The season is here for<br>special offers on<br>select Audi models."
        },
        {
            "name": "F3_local_txt",
            "type": "text",
            "default": "Local copy 30 character count."
        },
        {
            "name": "F3_headlineTxt_size_hex_xy",
            "type": "text",
            "default": "17.5|#FFF|30,143"
        },
        {
            "name": "F3_localTxt_size_hex_xy",
            "type": "text",
            "default": "8|#fff|73,500"
        },
        {
            "name": "cta_txt",
            "type": "text",
            "default": "Find your escape >"
        },
        {
            "name": "ctaTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": "11|#FFF|'audi-extendedbold'|auto|auto|85,437"
        },
        {
            "name": "disclaimerCTA_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "disclaimerTxt_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_toggle",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_carIMG_toggle",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_topLineHex_XY_bottomLineHex_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_carMake_txt",
            "type": "text",
            "default": "Be sure to use appropriate all-season or winter tires and<br>always drive in a manner appropriate for the conditions."
        },
        {
            "name": "F4_carMakeTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": "7.3|#fff|10,573"
        },
        {
            "name": "F4_carModel_txt",
            "type": "text",
            "default": "Be sure to use appropriate all-season or winter tires and<br>always drive in a manner appropriate for the conditions."
        },
        {
            "name": "F4_carModelTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": "7.3|#fff|10,573"
        },
        {
            "name": "F4_headline_txt",
            "type": "text",
            "default": "Be sure to use appropriate all-season or winter tires and<br>always drive in a manner appropriate for the conditions."
        },
        {
            "name": "F4_headline_txt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": "7.3|#fff|10,573"
        },
        {
            "name": "F4_subHeadline_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_subHeadline_txt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_leaseNum1_copy1_num2_copy2_num3_copy3_num4_copy4",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_leaseBlockNumTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_leaseBlockNumTxt_c1Padding_c2Padding_c3Padding_c4Padding",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_leaseBlock_copyTxt_size_hex",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_legal_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_legalTxt_size_hex_face_lineheight_spacing_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_disclaimerCta_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_disclaimerCtaTxt_size_hex_xy_offsetY",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_overlay_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_cta_txt",
            "type": "text",
            "default": ""
        },
        {
            "name": "F4_ctaTxt_size_hex_xy",
            "type": "text",
            "default": ""
        },
        {
            "name": "replayTxt_size_hex_xy",
            "type": "text",
            "default": "9|#FFF|256,12"
        },
        {
            "name": "bkgdHex_F1_F2_F3_F4",
            "type": "text",
            "default": ""
        },
        {
            "name": "logoHex_xy_EFlogoHex_xy_maxHeight",
            "type": "text",
            "default": ""
        },
        {
            "name": "promologoHex_xy_EFpromologoHex_xy_maxHeight",
            "type": "text",
            "default": ""
        },
        {
            "name": "clicktag1_url",
            "type": "text",
            "default": "https://www.audioffers.com/tri-state/global-incentives/index.htm"
        },
        {
            "name": "background_img",
            "type": "image",
            "default": "images/Audi_SeoASedan_Mid_F1_300x600.jpg"
        },
        {
            "name": "logo_img",
            "type": "image",
            "default": "images/logo_nonOffer_300x600_x2.png"
        },
        {
            "name": "promoLogo_img",
            "type": "image",
            "default": "images/promoLogo_nonOffer_300x600_x2.png"
        },
        {
            "name": "carIMG",
            "type": "image",
            "default": "images/Audi_SeoASedan_Mid_F2_300x600.jpg"
        },
        {
            "name": "carShimmerIMG",
            "type": "image",
            "default": "images/Audi_SeoASedan_Mid_F3_300x600.jpg"
        }
]

var imageArray = new Array(),
    loadedImgs = 0,
    checkTimer,
    adWidth,
    adHeight,
    jsCheck;

var tl; // timeline Max

window.onload = function() {
    main.classList.add(checkPlatform()[0] + "-" + checkPlatform()[1]);
    setInstantAds();
}

function search(nameKey, myArray){
    for (var i=0; i < myArray.length; i++) {
        if (myArray[i].name === nameKey) {
            return myArray[i];
        }
    }
}

function setInstantAds() {
    try {
        adWidth = 300;
        adHeight = 600;

        //FRAME 1 START
        var F1 = document.createElement("div");
        F1.id = "F1_cont";
        F1.style.position = "absolute";
        F1.style.left = "0px";
        F1.style.top = "0px";
        F1.style.width = adWidth + "px";
        F1.style.height = adHeight + "px";
        F1.style.pointerEvents = "none";
        main.appendChild(F1);

        var background_img = document.createElement("img");
        background_img.id = "background_img";
        background_img.style.position = "absolute";
        background_img.style.left = "0px";
        background_img.style.top = "0px";
        background_img.style.width = adWidth + "px";
        background_img.style.height = adHeight + "px";
        F1.appendChild(background_img);
        imageArray.push([background_img, search("background_img", manifest).default]);

        var logo_img = document.createElement("img");
        logo_img.id = "logo_img";
        logo_img.style.position = "absolute";
        logo_img.style.left = "0px";
        logo_img.style.top = "0px";
        logo_img.style.width = adWidth + "px";
        logo_img.style.height = adHeight + "px";
        F1.appendChild(logo_img);
        imageArray.push([logo_img, search("logo_img", manifest).default]);

        var promoLogo_img = document.createElement("img");
        promoLogo_img.id = "promoLogo_img";
        promoLogo_img.style.position = "absolute";
        promoLogo_img.style.left = "0px";
        promoLogo_img.style.top = "0px";
        promoLogo_img.style.width = adWidth + "px";
        promoLogo_img.style.height = adHeight + "px";
        F1.appendChild(promoLogo_img);
        imageArray.push([promoLogo_img, search("promoLogo_img", manifest).default]);

        var F1_headline_txt_style = search("F1_headlineTxt_size_hex_xy", manifest).default.split('|');
        var F1_headline_txt = document.createElement("div");
        F1_headline_txt.id = "F1_headline_txt";
        F1_headline_txt.classList.add("headlines");
        F1_headline_txt.classList.add("headlines-centered");
        F1_headline_txt.style.fontSize = F1_headline_txt_style[0] + "px";
        F1_headline_txt.style.color = F1_headline_txt_style[1];
        F1_headline_txt.style.left = F1_headline_txt_style[2].split(",")[0] + "px";
        F1_headline_txt.style.top = F1_headline_txt_style[2].split(",")[1] + "px";
        F1.appendChild(F1_headline_txt);
        F1_headline_txt.innerHTML = search("F1_headline_txt", manifest).default;

        var F1_disclaimer_txt_style = search("F4_carMakeTxt_size_hex_face_lineheight_spacing_xy", manifest).default.split('|');
        var F1_disclaimer_txt = document.createElement("div");
        F1_disclaimer_txt.id = "F1_disclaimer_txt";
        F1_disclaimer_txt.classList.add("disclaimers");
        F1_disclaimer_txt.style.fontSize = F1_disclaimer_txt_style[0] + "px";
        F1_disclaimer_txt.style.color = F1_disclaimer_txt_style[1];
        F1_disclaimer_txt.style.left = F1_disclaimer_txt_style[2].split(",")[0] + "px";
        F1_disclaimer_txt.style.top = F1_disclaimer_txt_style[2].split(",")[1] + "px";
        F1.appendChild(F1_disclaimer_txt);
        F1_disclaimer_txt.innerHTML = search("F4_carMake_txt", manifest).default;
        //FRAME 1 END

        //FRAME 2 START
        var F2 = document.createElement("div");
        F2.id = "F2_cont";
        F2.style.position = "absolute";
        F2.style.left = "0px";
        F2.style.top = "0px";
        F2.style.width = adWidth + "px";
        F2.style.height = adHeight + "px";
        F2.style.pointerEvents = "none";
        main.appendChild(F2);

        var carIMG = document.createElement("img");
        carIMG.id = "carIMG";
        carIMG.style.position = "absolute";
        carIMG.style.left = "0px";
        carIMG.style.top = "0px";
        carIMG.style.width = adWidth + "px";
        carIMG.style.height = adHeight + "px";
        F2.appendChild(carIMG);
        imageArray.push([carIMG, search("carIMG", manifest).default]);

        var f2_logo_img = document.createElement("img");
        f2_logo_img.id = "f2_logo_img";
        f2_logo_img.style.position = "absolute";
        f2_logo_img.style.left = "0px";
        f2_logo_img.style.top = "0px";
        f2_logo_img.style.width = adWidth + "px";
        f2_logo_img.style.height = adHeight + "px";
        F2.appendChild(f2_logo_img);
        imageArray.push([f2_logo_img, search("logo_img", manifest).default]);

        var F2_headline_txt_style = search("F2_headlineTxt_size_hex_xy", manifest).default.split('|');
        var F2_headline_txt = document.createElement("div");
        F2_headline_txt.id = "F2_headline_txt";
        F2_headline_txt.classList.add("headlines");
        F2_headline_txt.classList.add("headlines-centered");
        F2_headline_txt.style.fontSize = F2_headline_txt_style[0] + "px";
        F2_headline_txt.style.color = F2_headline_txt_style[1];
        F2_headline_txt.style.left = F2_headline_txt_style[2].split(",")[0] + "px";
        F2_headline_txt.style.top = F2_headline_txt_style[2].split(",")[1] + "px";
        F2.appendChild(F2_headline_txt);
        F2_headline_txt.innerHTML = search("F2_headline_txt", manifest).default;

        var F2_disclaimer_txt_style = search("F4_carModelTxt_size_hex_face_lineheight_spacing_xy", manifest).default.split('|');
        var F2_disclaimer_txt = document.createElement("div");
        F2_disclaimer_txt.id = "F2_disclaimer_txt";
        F2_disclaimer_txt.classList.add("disclaimers");
        F2_disclaimer_txt.style.fontSize = F2_disclaimer_txt_style[0] + "px";
        F2_disclaimer_txt.style.color = F2_disclaimer_txt_style[1];
        F2_disclaimer_txt.style.left = F2_disclaimer_txt_style[2].split(",")[0] + "px";
        F2_disclaimer_txt.style.top = F2_disclaimer_txt_style[2].split(",")[1] + "px";
        F2.appendChild(F2_disclaimer_txt);
        F2_disclaimer_txt.innerHTML = search("F4_carModel_txt", manifest).default;
        //FRAME 2 END

        //FRAME 3 START
        var F3 = document.createElement("div");
        F3.id = "F3_cont";
        F3.style.position = "absolute";
        F3.style.left = "0px";
        F3.style.top = "0px";
        F3.style.width = adWidth + "px";
        F3.style.height = adHeight + "px";
        F3.style.pointerEvents = "none";
        main.appendChild(F3);

        var carShimmerIMG = document.createElement("img");
        carShimmerIMG.id = "carShimmerIMG";
        carShimmerIMG.style.position = "absolute";
        carShimmerIMG.style.left = "0px";
        carShimmerIMG.style.top = "0px";
        carShimmerIMG.style.width = adWidth + "px";
        carShimmerIMG.style.height = adHeight + "px";
        F3.appendChild(carShimmerIMG);
        imageArray.push([carShimmerIMG, search("carShimmerIMG", manifest).default]);

        var f3_logo_img = document.createElement("img");
        f3_logo_img.id = "f3_logo_img";
        f3_logo_img.style.position = "absolute";
        f3_logo_img.style.left = "0px";
        f3_logo_img.style.top = "0px";
        f3_logo_img.style.width = adWidth + "px";
        f3_logo_img.style.height = adHeight + "px";
        F3.appendChild(f3_logo_img);
        imageArray.push([f3_logo_img, search("logo_img", manifest).default]);

        var f3_promoLogo_img = document.createElement("img");
        f3_promoLogo_img.id = "f3_promoLogo_img";
        f3_promoLogo_img.style.position = "absolute";
        f3_promoLogo_img.style.left = "0px";
        f3_promoLogo_img.style.top = "0px";
        f3_promoLogo_img.style.width = adWidth + "px";
        f3_promoLogo_img.style.height = adHeight + "px";
        F3.appendChild(f3_promoLogo_img);
        imageArray.push([f3_promoLogo_img, search("promoLogo_img", manifest).default]);

        var cta_txt_style = search("ctaTxt_size_hex_face_lineheight_spacing_xy", manifest).default.split('|');
        var cta_txt = document.createElement("div");
        cta_txt.id = "cta_txt";
        cta_txt.classList.add("cta");
        cta_txt.style.fontSize = cta_txt_style[0] + "px";
        cta_txt.style.color = cta_txt_style[1];
        cta_txt.style.fontFamily = cta_txt_style[2];
        cta_txt.style.lineHeight = cta_txt_style[3] + "px";
        cta_txt.style.letterSpacing = cta_txt_style[4] + "px";
        cta_txt.style.left = cta_txt_style[5].split(",")[0] + "px";
        cta_txt.style.top = cta_txt_style[5].split(",")[1] + "px";
        F3.appendChild(cta_txt);
        cta_txt.innerHTML = search("cta_txt", manifest).default;

        var F3_headline_txt_style = search("F3_headlineTxt_size_hex_xy", manifest).default.split('|');
        var F3_headline_txt = document.createElement("div");
        F3_headline_txt.id = "F3_headline_txt";
        F3_headline_txt.classList.add("headlines");
        F3_headline_txt.classList.add("headlines-centered");
        F3_headline_txt.style.fontSize = F3_headline_txt_style[0] + "px";
        F3_headline_txt.style.color = F3_headline_txt_style[1];
        F3_headline_txt.style.left = F3_headline_txt_style[2].split(",")[0] + "px";
        F3_headline_txt.style.top = F3_headline_txt_style[2].split(",")[1] + "px";
        F3.appendChild(F3_headline_txt);
        F3_headline_txt.innerHTML = search("F3_headline_txt", manifest).default;

        var F3_local_txt_style = search("F3_localTxt_size_hex_xy", manifest).default.split('|');
        var F3_local_txt = document.createElement("div");
        F3_local_txt.id = "F3_local_txt";
        F3_local_txt.classList.add("headlines");
        F3_local_txt.classList.add("headlines-centered");
        F3_local_txt.style.fontSize = F3_local_txt_style[0] + "px";
        F3_local_txt.style.color = F3_local_txt_style[1];
        F3_local_txt.style.left = F3_local_txt_style[2].split(",")[0] + "px";
        F3_local_txt.style.top = F3_local_txt_style[2].split(",")[1] + "px";
        F3_local_txt.style.textAlign = "justify";
        F3.appendChild(F3_local_txt);
        F3_local_txt.innerHTML = search("F3_local_txt", manifest).default;

        var F3_disclaimer_txt_style = search("F4_headline_txt_size_hex_face_lineheight_spacing_xy", manifest).default.split('|');
        var F3_disclaimer_txt = document.createElement("div");
        F3_disclaimer_txt.id = "F3_disclaimer_txt";
        F3_disclaimer_txt.classList.add("disclaimers");
        F3_disclaimer_txt.style.fontSize = F3_disclaimer_txt_style[0] + "px";
        F3_disclaimer_txt.style.color = F3_disclaimer_txt_style[1];
        F3_disclaimer_txt.style.left = F3_disclaimer_txt_style[2].split(",")[0] + "px";
        F3_disclaimer_txt.style.top = F3_disclaimer_txt_style[2].split(",")[1] + "px";
        F3.appendChild(F3_disclaimer_txt);
        F3_disclaimer_txt.innerHTML = search("F4_headline_txt", manifest).default;

        var replay_style = search("replayTxt_size_hex_xy", manifest).default.split('|');
        replay.style.position = "absolute";
        replay.style.visibility = "hidden";
        replay.style.pointerEvents = "auto";
        replay.style.cursor = "pointer";
        replay.style.fontFamily = "audi-normal";
        replay.style.textDecoration = "underline";
        replay.style.fontSize = replay_style[0] + "px";
        replay.style.color = replay_style[1];
        replay.style.left = replay_style[2].split(",")[0] + "px";
        replay.style.top = replay_style[2].split(",")[1] + "px";
        replay.innerHTML = "Replay";
        //FRAME 3 END

        //SPRITE
        var sprite = document.createElement("div");
        sprite.id = "sprite";
        sprite.style.position = "absolute";
        sprite.style.pointerEvents = "none";
        sprite.style.left = "0px";
        sprite.style.top = "0px";
        sprite.style.width = adWidth + "px";
        sprite.style.height = adHeight + "px";
        sprite.style.backgroundSize = "cover";
        main.appendChild(sprite);
        imageArray.push([sprite, "images/spritesheet_300x600.png"]);

        replay.addEventListener("click", function() {
            TweenLite.set(F1_headline_txt, {
                opacity: 0,
            });
            TweenLite.to(F1_cont, 1, {
                opacity: 1,
            });
            TweenLite.to(carShimmerIMG, 1, {
                opacity: 0,
            });
            TweenLite.to(f3_logo_img, 1, {
                opacity: 0,
            });
            TweenLite.to(f3_promoLogo_img, 1, {
                opacity: 0,
            });
            TweenLite.to(F3_headline_txt, 1, {
                opacity: 0,
            });
            TweenLite.to(F3_local_txt, 1, {
                opacity: 0,
            });
            TweenLite.to(F3_disclaimer_txt, 1, {
                opacity: 0,
            });
            TweenLite.to(replay, 1, {
                pointerEvents: "none",
                opacity: 0,
            });
            TweenLite.to(cta_txt, 1, {
                opacity: 0,
                onComplete: function() {
                    tl.restart();
                }
            });
        });



        preloadImage(initializeUnit);
    } catch (error) {
        console.error("Error on setInstantAds(): " + error.message);
    }
}

function preloadImage(callback) {
    try {
        a = imageArray;

        if (a.length != 0) {
            for (var i = 0; i < a.length; i++) {
                if (a[i][0].tagName.toLowerCase() == "img") {
                    a[i][0].src = a[i][1];
                    a[i][0].addEventListener("load", function f(e) {
                        e.currentTarget.removeEventListener(e.type, f);
                        loadedImgs++;
                    }, false);
                } else {
                    a[i][0].style.backgroundImage = "url('" + a[i][1] + "')";

                    var o = new Image();
                    o.src = a[i][1];
                    o.addEventListener("load", function f(e) {
                        e.currentTarget.removeEventListener(e.type, f);
                        loadedImgs++;
                    }, false);
                }
            }

            var t = setInterval(function() {
                if (a.length === loadedImgs) {
                    clearInterval(t);
                    callback();
                }
            }, 100);
        } else {
            setTimeout(callback, 100);
        }
    } catch (error) {
        console.error("Error on preloadImage(): " + error.message);
    }
}

function initializeUnit() {
//    try {
        var clickTagURL;
        if (search("versionName_txt", manifest).default != "" || search("URL_type_txt", manifest).default != "") {
            var isMLP;
            if(search("versionName_txt", manifest).default) {
                var getInfo = search("versionName_txt", manifest).default.split("_");

                region = getRegion(getInfo[3].toLowerCase());
                market = getInfo[6];
                tactic = getInfo[4];
                funnel = getFunnel(getInfo[5].toLowerCase());
                if (getInfo[7].indexOf("20") === -1) {
                    modelYear = "2020"
                    if (getInfo[8].toLowerCase() != "generic") {
                        model = getInfo[7].toLowerCase() + "-" + getInfo[8].toLowerCase();
                    } else {
                        model = getInfo[7].toLowerCase();
                    }
                } else {
                    modelYear = getInfo[7];
                    if (getInfo[9].toLowerCase() != "generic") {
                        model = getInfo[8].toLowerCase() + "-" + getInfo[9].toLowerCase();
                    } else {
                        model = getInfo[8].toLowerCase();
                    }
                }    
            }

            var lookupType = search("URL_type_txt", manifest).default.toLowerCase().split(" ").join("").split("-").join("");

            if (lookupType == "modellandingpage") {
                lookupType = "mlp";
            }
            if (search("clicktag1_url", manifest).default == "") {
                if (lookupType != "dealersite" && lookupType != "mlp") {
                    loadURLs("js/" + getInfo[3].toLowerCase() + "_" + lookupType + ".js");
                } else if (lookupType != "dealersite") {
                    isMLP = true;
                    loadURLs("js/mlp.js");
                } else {
                    loadURLs("js/dealer_sites.js");
                }
            }
            setTimeout(function() {
                if (search("versionName_txt", manifest).default != "") {
                    if (!search("clicktag1_url", manifest).default) {
                        if (lookupType === "globalincentives") {
                            if (t3Check(market.toLowerCase())) {
                                clickOut = getURL(market.toLowerCase().split("-mia").join("") + "||" + model.toLowerCase() + "||" + modelYear);
                            } else {
                                clickOut = getURL(market.toLowerCase().split("-mia").join("") + "||" + model.toLowerCase());
                            }
                        } else if (lookupType != "dealersite" && lookupType != "mlp") {
                            clickOut = getURL(market.toLowerCase().split("-mia").join("") + "||" + model.toLowerCase());
                        } else if (lookupType != "dealersite") {
                            clickOut = getURL(model.toLowerCase());
                        } else {
                            clickOut = getURL(market.toLowerCase().split("-mia").join(""));
                        }

                        if (isMLP) {
                            if (clickOut.indexOf('?') != -1) {
                                clickTagURL = clickOut + "&csref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                            } else {
                                clickTagURL = clickOut + "?csref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                            }
                        } else {
                            if (clickOut.indexOf('?') != -1) {
                                clickTagURL = clickOut + "&ddcref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                            } else {
                                clickTagURL = clickOut + "?ddcref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                            }
                        }

                    } else {
                        clickOut = search("clicktag1_url", manifest).default;

                        if (clickOut.indexOf('?') != -1) {
                            clickTagURL = clickOut + "&ddcref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                        } else {
                            clickTagURL = clickOut + "?ddcref=t2_programmatic-display_PHDP_AO_" + region + "_" + market + "_x_" + funnel + "_" + modelYear + "_" + model.split('e-tron').join('etron').split('a5-sportback').join('a5') + "_PHD_x_x_2020-01-07";
                        }
                    }

                } else {
                    clickTagURL = search("clicktag1_url", manifest).default;
                }
            },500);

        } else {
            clickTagURL = search("clicktag1_url", manifest).default;
        }

        setTimeout(function() {
//            myFT.applyClickTag(main, 1, clickTagURL);
            main.style.visibility = "visible";
            replay.style.visibility = "visible";
            startAnimation();
        }, 500);

//    } catch (error) {
//        console.error("Error on initializeUnit(): " + error.message);
//    }
}

function loadURLs(filename) {
    var fileref = document.createElement("script");
    fileref.setAttribute("type", "text/javascript");
    fileref.src = filename;
    if (typeof fileref != "undefined") {
        document.getElementsByTagName("head")[0].appendChild(fileref);
        jsCheck = fileref;
    }
}

function getRegion(regKey) {
    switch (regKey) {
        case "aue":
            return "eastern";
        case "acr":
            return "central";
        case "awr":
            return "western";
        case "ais":
            return "southern";
    }
}

function getFunnel(funnKey) {
    switch (funnKey) {
        case "interest":
            return "interest_traffic";
        case "evaluation":
            return "evaluation_traffic";
        case "intent":
            return "intent_qualified-actions";
        case "action":
            return "action_leads";
    }
}

function startAnimation() {
    tl = new TimelineMax();

    tl.fromTo(F1_headline_txt, 0.5, {
        opacity: 0,
        y: 5
    }, {
        opacity: 1,
        y: 0,
        ease: Power4.easeInOut
    }, 0.25);
    
    tl.to(F1_cont, 2, {
        opacity: 0,
    }, '+=2');
    
    tl.add("transition1")
    
    tl.fromTo(sprite, 3, {
        backgroundPosition: "0px 0px",
    }, {
        backgroundPosition: "-19200px 0px",
        ease: "steps(64)",
    }, 'transition1-=2.5');

    tl.fromTo(carIMG, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition1-=1');

    tl.fromTo(f2_logo_img, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition1-=1');

    tl.fromTo(F2_disclaimer_txt, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition1-=1');

    tl.fromTo(F2_headline_txt, 0.5, {
        opacity: 0,
        y: 5
    }, {
        opacity: 1,
        y: 0,
        ease: Power4.easeInOut
    }, '-=0.95');

    tl.to(F2_cont, 2, {
        opacity: 0,
    }, '+=2');
    
    tl.add("transition2")

    tl.fromTo(sprite, 3, {
        backgroundPosition: "0px 0px",
    }, {
        backgroundPosition: "-19200px 0px",
        ease: "steps(64)",
    }, 'transition2-=2.5');

    tl.fromTo(carShimmerIMG, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(f3_logo_img, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(f3_promoLogo_img, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');
    
    tl.fromTo(F3_disclaimer_txt, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(cta_txt, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(F3_local_txt, 2, {
        opacity: 0
    }, {
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(replay, 2, {
        pointerEvents: "none",
        opacity: 0
    }, {
        pointerEvents: "auto",
        opacity: 1,
    }, 'transition2-=1');

    tl.fromTo(F3_headline_txt, 0.5, {
        opacity: 0,
        y: 5
    }, {
        opacity: 1,
        y: 0,
        ease: Power4.easeInOut
    }, '-=0.95');
}

function checkPlatform() {
    try {
        var a = new Array();

        if (navigator.platform.toLowerCase().indexOf("mac") > -1) {
            a[0] = "macOS";
        } else if (navigator.platform.toLowerCase().indexOf("win") > -1) {
            a[0] = "windows";
        } else {
            if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
                a[0] = "iOS";
            } else if (navigator.userAgent.match(/Opera Mini/i)) {
                a[0] = "opera";
            } else if (navigator.userAgent.match(/Android/i)) {
                a[0] = "android";
            } else if (navigator.userAgent.match(/BlackBerry/i)) {
                a[0] = "BlackBerry";
            } else if (navigator.userAgent.match(/IEMobile/i) || navigator.userAgent.match(/WPDesktop/i)) {
                a[0] = "WindowsPhone";
            }
        }

        var MSIE = window.navigator.userAgent.indexOf("MSIE ");
        var Edge = window.navigator.userAgent.indexOf("Edge/");
        var Trdt = window.navigator.userAgent.indexOf("Trident/");

        if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
            a[1] = "chrome";
        } else if (navigator.userAgent.toLowerCase().indexOf("firefox") > -1) {
            a[1] = "firefox";
        } else if (navigator.vendor && navigator.vendor.toLowerCase().indexOf("apple") > -1) {
            a[1] = "safari";
        } else if (MSIE > 0 || Edge > 0 || Trdt > 0) {
            a[1] = "IE";
        }

        return a;
    } catch (error) {
        console.error("Error on checkPlatform(): " + error.message);
    }
}

function t3Check (urlKeyCode){
    switch (urlKeyCode){
        case 'grand-rapids':
            return true;
        case 'indianapolis':
            return true;
        case 'louisville':
            return true;
        case 'toledo':
            return true;
        case 'wichita':
            return true;
        case 'baton-rouge':
            return true;
        case 'birmingham':
            return true;
        case 'cape-fear':
            return true;
        case 'charlottesville':
            return true;
        case 'columbia':
            return true;
        case 'el-paso':
            return true;
        case 'lafayette':
            return true;
        case 'little-rock':
            return true;
        case 'memphis':
            return true;
        case 'nashville':
            return true;
        case 'new-orleans':
            return true;
        case 'providence':
            return true;
        case 'richmond':
            return true;
        case 'san-juan':
            return true;
        case 'tulsa':
            return true;
        case 'albany':
            return true;
        case 'albuquerque':
            return true;
        case 'boise':
            return true;
        case 'colorado-springs':
            return true;
        case 'honolulu':
            return true;
        case 'palm-springs':
            return true;
        case 'reno':
            return true;
        case 'santa-barbara':
            return true;
        case 'spokane':
            return true;
        default:
            return false;
    }
}